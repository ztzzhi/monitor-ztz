{"code":"import { createRouterEvent } from \"../utils/createRouterEvent\";\nclass Monitor {\n    constructor(options) {\n        this.options = options;\n        this.pageStartTime = this.getTime();\n        this.addEventListener();\n        this.installRouterTracker();\n    }\n    // 添加监听事件\n    addEventListener() {\n        window.history[\"pushState\"] = createRouterEvent(\"pushState\");\n        window.history[\"replaceState\"] = createRouterEvent(\"replaceState\");\n    }\n    // 监听路由变化统计pv\n    installRouterTracker() {\n        if (this.options.historyTracker) {\n            this.handleHistoryEvents();\n        }\n        else {\n        }\n        this.getStayTime();\n    }\n    // history路由变化时逻辑\n    handleHistoryEvents() {\n        [\"pushState\", \"popstate\", \"replaceState\"].forEach((item) => {\n            window.addEventListener(item, () => {\n                console.log(\"我监听到了\");\n            });\n        });\n    }\n    // 统计页面停留时长\n    getStayTime() {\n        [\"load\", \"unload\", \"hashchange\", \"pushState\", \"replaceState\"].forEach((item) => {\n            window.addEventListener(item, () => {\n                if (item == \"load\") {\n                    this.pageStartTime = this.getTime();\n                }\n                else if (item === \"hashchange\" ||\n                    item === \"pushState\" ||\n                    item === \"relpaceState\") {\n                    let stayTime = this.calcStayTime();\n                    if (stayTime > 0.1) {\n                        console.log(stayTime, \"this.pageStartTime\");\n                        this.pageStartTime = this.getTime();\n                    }\n                }\n                console.log(\"staty\", item);\n            });\n        });\n    }\n    getTime() {\n        return new Date().getTime();\n    }\n    calcStayTime() {\n        return this.getTime() - this.pageStartTime;\n    }\n    static lazyReport() { }\n}\n// @ts-ignore\nwindow.Monitor = Monitor;\nexport default Monitor;\n","references":["/Users/ztz/myPro/ztz-monitor/src/types/index.ts","/Users/ztz/myPro/ztz-monitor/src/utils/createRouterEvent.ts"]}
